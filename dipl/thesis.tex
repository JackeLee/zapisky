\documentclass[12pt,a4paper]{report}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{amsthm,amsfonts,amssymb}
\usepackage{amsmath}
\usepackage[inline,shortlabels]{enumitem}
\usepackage{a4wide}
\usepackage{titlesec}
\usepackage{makeidx}
\usepackage{tikz-cd}
\usepackage{tikz}
\usepackage{braket}
\usepackage{zref}


\usetikzlibrary{matrix, calc, arrows, fit}
\tikzset{commutative diagrams/.cd}
\tikzset{commutative diagrams/row    sep/normal=1.3cm}
\tikzset{commutative diagrams/column sep/normal=1.3cm}
\makeindex

% Formating of theorems, lemmas, ...
\titlelabel{\thetitle.\quad}

\def\afterDotSpace{.5em}

% Proper labeling and referencing
% http://tex.stackexchange.com/questions/57799/refer-to-theorems-in-previous-chapter
\makeatletter
\let\oldlabel\label
\renewcommand{\label}[1]{%
  \zref@labelbylist{#1}{special}% Special label
  \oldlabel{#1}% Old label
}
\newcounter{splabel}
\zref@newlist{special}% Create a new property list called special
\zref@newprop{chapter}{\Roman{chapter}}% Section property holds \arabic{chapter}
\zref@addprop{special}{chapter}% Add a chapter property to special
\let\oldref\ref
\newcommand*{\thmref}[1]{%
  \stepcounter{splabel}% Increment local "special label" counter
  \zref@labelbylist{#1-\thesplabel}{special}% Create label
  \edef\targetchap{\zref@extractdefault{#1}{chapter}{-1}}% Extract target chapter
  \edef\sourcechap{\zref@extractdefault{#1-\thesplabel}{chapter}{-1}}% Extract source chapter
  % (My modification) The way how to compare two strings:
  \ifnum\pdfstrcmp{\targetchap}{\sourcechap}=0\else\targetchap.\fi%
  \oldref{#1}%
}
\renewcommand\ref[1]{\thmref{#1}}
\makeatother

% Counting and environments
\newcounter{thmCounter}[section]
\renewcommand \thechapter{\Roman{chapter}}
\renewcommand \thesection{\arabic{section}}
\renewcommand{\thethmCounter}{\thesection.\arabic{thmCounter}}

\def\blockHelperA{\par\medskip\noindent}
\def\blockHelperB{\refstepcounter{thmCounter}\textbf{\arabic{section}.\arabic{thmCounter}.}}
\def\blockHelperCA{\hspace{\afterDotSpace}\ignorespaces}
\def\blockHelperCB{\it\blockHelperCA}

\def\blockEnv#1{\blockHelperA\blockHelperB{\bf~#1.}\blockHelperCA}
\def\blockEnvS#1{\blockHelperA{\bf #1.}\blockHelperCA}
\def\blockPropEnv#1{\blockHelperA\blockHelperB{\bf~#1.}\blockHelperCB}
\def\blockPropEnvS#1{\blockHelperA{\bf #1.}\blockHelperCB}
\def\endBlockEnv{\par\medskip}

% TODO add little space before numbered paragraph
\def\num{\blockHelperA\blockHelperB\hspace{\afterDotSpace}}

\newenvironment{block}{\blockEnv}{\endBlockEnv}
\newenvironment{block*}{\blockEnvS}{\endBlockEnv}
\newenvironment{blockProp}{\blockPropEnv}{\endBlockEnv}
\newenvironment{blockProp*}{\blockPropEnvS}{\endBlockEnv}

\newtheoremstyle{newthmstyle}% name of the style to be used
    {8pt}% measure of space to leave above the theorem. E.g.: 3pt
    {3pt}% measure of space to leave below the theorem. E.g.: 3pt
    {\itshape}% name of font to use in the body of the theorem
    {}% measure of space to indent
    {\bfseries}% name of head font
    {.}% punctuation between head and body
    {\afterDotSpace}% space after theorem head; " " = normal interword space
    {\thmnumber{#2. }\thmname{#1}\thmnote{ \rm [#3]}}% Manually specify head

\newtheoremstyle{newthmstyleNormal}{8pt}{3pt}{}{}{\bfseries}{.}{\afterDotSpace}
    {\thmnumber{#2. }\thmname{#1}\thmnote{ \rm [#3]}}

\theoremstyle{newthmstyle}
\newtheorem{lemma}[thmCounter]{Lemma}
\newtheorem{theorem}[thmCounter]{Theorem}
\newtheorem{conclusion}[thmCounter]{Conclusion}
\newtheorem{proposition}[thmCounter]{Proposition}
\newtheorem{observation}[thmCounter]{Observation}
\newtheorem*{lemma*}{Lemma}
\newtheorem*{theorem*}{Theorem}
\newtheorem*{conclusion*}{Conclusion}
\newtheorem*{proposition*}{Proposition}
\newtheorem*{observation*}{Observation}

\theoremstyle{newthmstyleNormal}
\newtheorem{definition}[thmCounter]{Definition}
\newtheorem*{definition*}{Definition}

% Categories
\newcommand\categoryStyle[1]{\ensuremath{\mathbf{#1}}}
\newcommand\Frm{\categoryStyle{Frm}}
\newcommand\StoneFrm{\categoryStyle{StoneFrm}}
\newcommand\ExtrStoneFrm{\categoryStyle{ExtrDStoneFrm}}
\newcommand\Top{\categoryStyle{Top}}
\newcommand\StoneSp{\categoryStyle{StoneSp}}
\newcommand\Bool{\categoryStyle{Bool}}
\newcommand\ComplBool{\categoryStyle{ComplBool}}
\newcommand\CRegFrm{\categoryStyle{CRegFrm}}
\newcommand\RegKFrm{\categoryStyle{RegKFrm}}

% Special symbols
\newcommand\R{\ensuremath{\mathfrak{R}}}
\newcommand\C{\ensuremath{\mathcal{R}}}
\newcommand\J{\ensuremath{\mathfrak{J}}}
\newcommand\p[1]{\ensuremath{\mathcal{ #1 }}}
\newcommand\Bo{\ensuremath{\mathfrak{B}}} % booleanization
\newcommand\Bc{\ensuremath{\mathbb{B}}} % boolean/complemented elements
\newcommand\Sp{\ensuremath{\mathcal{S}}}
\newcommand\closure[1]{\overline{#1}}
\newcommand\upset  {\mathord{\uparrow}\mkern1mu}
\newcommand\downset{\mathord{\downarrow}\mkern1mu} % mathord/mathbin/mathrel treats symbol as oordinal math symbol/binary relation/...
\newcommand\rbelow{\prec}
\newcommand\crbelow{\rbelow\mkern-7mu\rbelow}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Id}{Id}
\DeclareMathOperator{\Ult}{Ult}
\def\InclUp{\rotatebox[origin=c]{90}{$\subseteq$}}
\def\DotsUp{\rotatebox[origin=c]{90}{\dots}}

% Function restriction
% http://tex.stackexchange.com/questions/22252/how-to-typeset-function-restrictions
\newcommand\restr[2]{{% we make the whole thing an ordinary symbol
  \left.\kern-\nulldelimiterspace % automatically resize the bar with \right
  #1 % the function
  \vphantom{\big|} % pretend it's a little taller at normal size
  \right|_{#2} % this is the delimiter
}}

% Other stuff
\newcommand\DEF[2][]{\emph{#2}\index{#2#1}}
  % example \DEF[|see{null-dimensional}]{zero-dimensional}
\newcommand\DEFSYM[3][a ]{\emph{#3}\index{#1#2@#3}\ignorespaces}

\newenvironment{diagram}{\begin{center}\begin{tikzcd}}{\end{tikzcd}\end{center}}
\newcommand\ACP{\hfill\fontshape{n}{\textbf{($\star$)}}}

\title{Some point--free aspects of connectedness}
\author{Tom\'a\v s Jakl}

\begin{document}
\maketitle
\tableofcontents

\input{data/01-Introduction.tex}
\input{data/02-Preliminaries.tex}
\input{data/03-ConnectednessAndCompactification.tex}
\input{data/04-StoneDuality.tex}
\input{data/05-PartsOfDuality.tex}


\chapter{More about DeMorgan Frames}

\begin{center}
\begin{tikzpicture}[descr/.style={fill=white,inner sep=2.5pt}]
    \tikzset{
      mymx/.style={
        matrix of nodes,
        % nodes=block,
        row sep=3.5em,
        column sep=3.5em,
      },
      lbl/.style={
        % above,
        below,
        auto,
        % pos=0.15,
        % sloped, % make the text follow the path
        %execute at begin node={$}, % begin math mode, for the minus signs etc.
        %execute at end node={$}, % end math mode
      }
    }
    \tikzstyle{bigbox} = [draw=gray, thick, rounded corners, rectangle]

    \pgfmathsetmacro{\H}{1.0}
    \pgfmathsetmacro{\W}{0.6}

    \matrix (m) [mymx]
        { KRFrm & & RFrmB \\
          StoneFrm & Bool & \\
          KDMFrm & CBool & DMFrm \\
        };
    \path[->,font=\scriptsize,every node/.style=lbl]
        (m-2-1)     edge node {\InclUp} (m-1-1)
        (m-3-1)     edge node {\InclUp} (m-2-1)
        (m-3-3)     edge node {\InclUp} (m-1-3)
        (m-3-2)     edge node {\InclUp} (m-2-2)
        (m-3-2)     edge node {$ \subseteq^{\text{obj}}$} (m-3-3)

        % Stone duality
        (m-2-2) edge[transform canvas={yshift=1.5pt}]  node[swap] {Ideals}  (m-2-1)
        (m-2-1) edge[transform canvas={yshift=-1.5pt}] node[swap] {Boolean} (m-2-2)

        % Compact. Reflection
        (m-1-1.355) edge node[swap] {Forget} (m-1-3.185)
        (m-1-3.175) edge node[swap] {Comp} (m-1-1.5);

    \path[<->, thick]
        (m-3-1) edge node {} (m-3-2);


    \node[bigbox, dotted] [fit = (m-2-1) (m-3-2)] {};
    \draw[gray, rounded corners, dashed]
           ($(m-1-1) + (-\H,   0)$)
        -- ($(m-1-1) + (-\H, +\W)$)
        -- ($(m-1-3) + (+\H, +\W)$)
        -- ($(m-3-3) + (+\H, -\W)$)
        -- ($(m-3-3) + (-\H, -\W)$)
        -- ($(m-1-3) + (-\H, -\W)$)
        -- ($(m-1-1) + (-\H, -\W)$)
        -- ($(m-1-1) + (-\H,   0)$);
\end{tikzpicture}
\end{center}

\begin{diagram}[row sep=0.7cm]
    \StoneFrm
        \ar[yshift=0.2em]{r}{\scalebox{1.5}\Bc}
    & \Bool
        \ar[yshift=-0.2em]{l}{\scalebox{1.5}\J} \\
    \\
    \sigma\text{--}\categoryStyle{BDStoneFrm}
        \ar[yshift=0.2em]{r}{\scalebox{1.5}\Bc}
        \ar{uu}{\InclUp}
    & \sigma\text{--}\ComplBool
        \ar{uu}{\InclUp}
        \ar[yshift=-0.2em]{l}{\scalebox{1.5}\J} \\
    \DotsUp
        \ar{u}{\InclUp}
    & \DotsUp
        \ar{u}{\InclUp} \\
    \kappa\text{--}\categoryStyle{BDStoneFrm}
        \ar[yshift=0.2em]{r}{\scalebox{1.5}\Bc}
        \ar{u}{\InclUp}
    & \kappa\text{--}\ComplBool
        \ar{u}{\InclUp}
        \ar[yshift=-0.2em]{l}{\scalebox{1.5}\J} \\
    \DotsUp
        \ar{u}{\InclUp}
    & \DotsUp
        \ar{u}{\InclUp} \\
    \ExtrStoneFrm
        \ar[yshift=0.2em]{r}{\scalebox{1.5}{$\Bo\;\cong\;\Bc$}}
        \ar{u}{\InclUp}
    & \ComplBool
        \ar{u}{\InclUp}
        \ar[yshift=-0.2em]{l}{\scalebox{1.5}\J} \\
\end{diagram}

\section{Uniformity and metrizability}
\section{Non--metrizability of compactification}
\begin{lemma}
    For $L$ normal frame: $\sigma(x)\vee\sigma(x) = \sigma(x\vee y)$.
\end{lemma}

\chapter{Conclusion}
TODO or Further work?


\bibliographystyle{plain}
\bibliography{refs.bib}

\clearpage
% \addcontentsline{toc}{chapter}{Index}
\printindex
\end{document}
