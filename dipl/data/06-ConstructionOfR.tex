\chapter{Construction of \R}

\section{Summarization}
% TODO proper references

Recall Theorem~\ref{p:universalCompactification}, the compactification of a complete regular frames is obtained as the frame of all regular ideals. The construction of a Stone frame in the Stone correspondence (IV.1.9) is given in similar fashion. The functor $\JO$ maps a Boolean algebra to the frame of all ideals of the Boolean algebra. On the other hand, in any Boolean algebra the relations $\leq$, $\rbelow$ and $\crbelow$ coincide. Thus, we can equivalently say that any Stone frame is obtained from a Boolean algebra by taking the frame of all regular ideals.

In Set--theoretical topology are the compactification and the Stone representation of Boolean algebras essentially the same.
The compactification of a completely regular topological space is homeomophic to the space of all ultrafilters of that space. Similarly in the Stone duality for topological spaces, each Stone space is constructed as the space of all ultrafilters of some Boolean algebra.

The whole (point-free) situation is depicted in the diagram below.

% \begin{block}{Note}
%     Compactification of a completely regular topological space $(X, \tau)$ is homeomophic to the space $\Ult(X) = (\Set{ U \subseteq \tau | U\text{ is an ultrafilter}}, \Set{\dots})$.
% \end{block}

\begin{center}
\begin{tikzpicture}[descr/.style={fill=white,inner sep=2.5pt}]
    \tikzset{
      mymx/.style={
        matrix of nodes,
        % nodes=block,
        row sep=3.5em,
        column sep=3.5em,
      },
      lbl/.style={
        % above,
        below,
        auto,
        % pos=0.15,
        % sloped, % make the text follow the path
        %execute at begin node={$}, % begin math mode, for the minus signs etc.
        %execute at end node={$}, % end math mode
      }
    }
    \tikzstyle{bigbox} = [draw=gray, thick, rounded corners, rectangle]

    \pgfmathsetmacro{\H}{1.2}
    \pgfmathsetmacro{\W}{0.6}

    \matrix (m) [mymx]
        { \RegKFrm & & \CRegFrm \\
          \StoneFrm & \Bool & \\
          \categoryStyle{KDMRFrm} & \categoryStyle{CBool} & \categoryStyle{DMRFrm} \\
        };
    \path[->,font=\scriptsize,every node/.style=lbl]
        (m-2-1)     edge node {\InclUp} (m-1-1)
        (m-3-1)     edge node {\InclUp} (m-2-1)
        (m-3-3)     edge node {\InclUp} (m-1-3)
        (m-3-2)     edge node {\InclUp} (m-2-2)
        (m-3-2)     edge node {$ \subseteq^{\text{obj}}$} (m-3-3)

        % Stone duality
        (m-2-2) edge[transform canvas={yshift=1.5pt}]  node[swap] {\JO}  (m-2-1)
        (m-2-1) edge[transform canvas={yshift=-1.5pt}] node[swap] {\BcO} (m-2-2)

        % Compact. Reflection
        (m-1-1.355) edge node[swap] {$\subseteq$} (m-1-3.185)
        (m-1-3.175) edge node[swap] {\C} (m-1-1.5);

    \path[<->, thick]
        (m-3-1) edge node {} (m-3-2);


    \node[bigbox, dotted] [fit = (m-2-1) (m-3-2)] {};
    \draw[gray, rounded corners, dashed]
           ($(m-1-1) + (-\H,   0)$)
        -- ($(m-1-1) + (-\H, +\W)$)
        -- ($(m-1-3) + (+\H, +\W)$)
        -- ($(m-3-3) + (+\H, -\W)$)
        -- ($(m-3-3) + (-\H, -\W)$)
        -- ($(m-1-3) + (-\H, -\W)$)
        -- ($(m-1-1) + (-\H, -\W)$)
        -- ($(m-1-1) + (-\H,   0)$);
\end{tikzpicture}
\end{center}

Where the symbol $\subseteq^{\text{obj}}$ denotes inclusion of objects of one category to another. New categories in the diagram are: \categoryStyle{CBool} denotes the category of complete Boolean algebras and \emph{all} Boolean homomorphisms. The category \categoryStyle{KDMRFrm} is the category of all extremally disconnected Stone spaces, or in other words all compact De Morgan regular frames, and \emph{all} frame homomorphisms. \categoryStyle{RegKFrm} denotes the category of compact regular frames, \categoryStyle{CRegFrm} the category of completely regular frames.)

In the area surrounded by the dotted rectangle in the picture is the Stone duality and in the area surrounded by the dashed curve is the compactification. As we know from the discussion above, the construction on objects is exactly the same for both marked parts of the diagram. However, the Stone correspondence is an isomorphism of categories, whereas the compactification is just a coreflection (of completely regular frames onto compact regular frames).

Taking the frame of all regular ideals of a bounded pseudocomplemented lattice is a general construction of compact frames. A natural question arises: Is it possible to extend the category \ComplBool{} to a wider subcategory of \categoryStyle{DMRFrm} and again obtain an isomorphism of categories witnessed by \R{}? From the following diagram we can see why it is not possible.

\begin{diagram}
    \categoryStyle{KDMRFrm} \ar[<->, thick]{r}{} & \categoryStyle{CBool} \ar{r}{\subseteq^{\text{obj}}} & \categoryStyle{DMRFrm} \ar[bend right=20,swap]{ll}{\restr{\C}{\categoryStyle{DMRFrm}}} \\
    \ExtrStoneFrm \ar[yshift=-0.2em,swap]{r}{\BcI}\ar{u}{\InclUp} & \ComplBool \ar[yshift=0.2em,swap]{l}{\JI} \ar{u}{\InclUp} \ar{ru}{\subseteq}
\end{diagram}

Objects of \categoryStyle{CBool} are in correspondence with objects of \categoryStyle{KDMRFrm}. On the other hand, \R{} provides a coreflection of the category \categoryStyle{DMRFrm} onto \categoryStyle{KDMRFrm}. Since \ComplBool{} is subcategory of \categoryStyle{CBool}, we cannot hope to expand the correspondence by extending the category \ComplBool{} into a wider subcategory of \categoryStyle{DMRFrm}.

% we have in the category all (regular) De Morgan frames as objects, we cannot expect from \R{} to form an isomorphism, because we know, the category of compact (regular) De Morgan frames is (non--isomorphically) coreflexive in the category of (regular) De Morgan frames~\ref{p:extrDiscPreserv} (certainly, there exists a non--compact (regular) De Morgan frame).

% TODO Compare compactification in classical and in point-free setting. Mention that \JI{} correspond to compactification, the topology of Ult is isomorphic to ideal lattice of Boolean algebra and that this was known~\cite{monk1989handbook}.
% (note: Taken from the big picture of Stone duality)

\section{Booleanization}

\begin{definition}\label{d:Booleanization}
    Let $H$ be a Heyting algebra, by \DEF{Booleanization} of $H$ we mean the set
    $$
    \DEFSYM{Booleanization}{\Bo H} = \Set{ a^{**} | a \in H }.
    $$
\end{definition}

\begin{proposition}
    Let $H$ be a Heyting meet--semilattice, then $\Bo H$, with joins and meets defined
    $$ a \sqcup b = (a^* \wedge b^*)^* \quad\text{and}\quad a\sqcap b = a \wedge b,$$

    \noindent is a Boolean algebra.
\end{proposition}
\begin{proof}
    First, we will show that $\sqcap$ really is the meet, $\sqcup$ is the join and both operations are well--defined. For $a,b,c \in \Bo H$:

    \begin{itemize}
        \item From~\ref{p:pseudcomplProperties}, $a\sqcap b = a^{**}\wedge b^{**} = (a\wedge b)^{**} \in \Bo H$.
        \item Whenever $a,b \leq c$, then $a^*, b^*\geq c^*$ and so $a^*\wedge b^*\geq c^*$, hence $a\sqcup b = (a^*\wedge b^*)^* \leq c^{**} = c$. And trivially, $a\sqcup b \in \Bo H$.
    \end{itemize}

    For $a \in \Bo H$: $a^* = a^{***} \in \Bo H$ too, $a\sqcup a^* = (a^*\wedge a^{**})^* = 0^* = 1$ and also $a\sqcap a^* = a\wedge a^* = 0$. Hence, each element is complemented and $\Bo H$ is a Boolean algebra.
\end{proof}

\num\label{p:propertiesBooleanization}
    Let $L$ be a frame, the mapping defined as $a \mapsto a^{**}$ is a nucleus:
    \begin{enumerate}[label=(N\arabic*)]
        \item $a \leq a^{**}$: From the definition of pseudocomplement we have $a \wedge a^* = 0$ iff $a \leq a^{**}$ and the first is always true (again, from the definition);
        \item $(a \leq b \implies a^{**} \leq b^{**})$: holds, since taking pseudocomplements is antitone;
        \item $a^{**\;**} = a^{**}$: simply from $a^* = a^{***}$; and
        \item $(a \wedge b)^{**} = a^{**} \wedge b^{**}$: it is a standard equality (Lemma~\ref{p:pseudcomplProperties}).
    \end{enumerate}

    Therefore, by~\ref{p:nuclProp}, $\Bo L$ is a sublocale of $L$ and consequently a complete Boolean algebra. As a drirect consequence of~\ref{p:nuclProp}, the mapping
    $$\text{\DEFSYM{BetaL}{$\beta_L$}}\colon L \to \Bo L,\quad a \mapsto a^{**},$$

    is a frame homomorphism.

\begin{block}{Note}
    $\Bo L$ is the smallest dense sublocale of $L$; and joins are also given by the following formula $(a \vee b)^{**}$ (since $a \mapsto a^{**}$ is a nucleus).
\end{block}


\begin{definition}\label{d:BooleanizationMorph}
    For a frame homomorphism $f\colon H \to K$, set \DEFSYM{BooleanizationMorph}{$\Bo f$}$\colon \Bo H \to \Bo K$ to be the mapping
    $$\Bo f\colon a \mapsto f(a)^{**}.$$
\end{definition}

\num\label{p:boolenizationCond} The following Proposition is taken from~\cite{banaschewski1996booleanization}.
\begin{proposition*}
    Let $f\colon L \to M$ be a frame homomorphism, then $\Bo f$ is a frame homomorphism such that the following diagram commutes
    \begin{diagram}
        L \ar{r}{\beta_L} \ar{d}{f} & \Bo L \ar{d}{\Bo f}\\
        M \ar{r}{\beta_M}           & \Bo M
    \end{diagram}
    if and only if $f(a^{**}) \leq f(a)^{**}$ for all $a \in L$.
\end{proposition*}
\begin{proof}
    First observe that
    \begin{align}
        f(a^{**})^{**} = f(a)^{**} \iff f(a^{**}) \leq f(a)^{**},\quad\text{for all } a\in L.\label{e:2202iff20leq02}\tag{W.O.}
    \end{align}

    $\Leftarrow$ is straightforward and the $\Rightarrow$ implication follows simply from $f(a^{**}) \leq f(a^{**})^{**} $. And the diagram commutes iff $f(a^{**})^{**} = f(a)^{**}$.

    The last thing we need to show is that $f(a^{**}) \leq f(a)^{**}$ implies that $\Bo f$ is a frame homomorphism. It is straightforward to see that $\Bo f$ preserves $0$, $1$ and $\sqcap$. For $\sqcup$--preserving, take $a, b \in \Bo L$ and infer
    $$(\Bo f)(a)\sqcup (\Bo f)(b) = (f(a)^{**}\vee f(b)^{**})^{**} \geq f(a^{**}\vee b^{**})^{**} = f(a\vee b)^{**} = (\Bo f)(a\sqcup b),$$

    \noindent where the middle and the last equality hold by~(\oldref{e:2202iff20leq02}). The opposite inequality follows from: $f(a)^{**}\vee f(b)^{**}\leq f(a\vee b)^{**}$, thus $\Bo f$ is a Boolean homomorphism.

    Let's show $\Bo f$ preserves big joins. Again using~(\oldref{e:2202iff20leq02}), we get
    $$ (\Bo f)(\bigsqcup A) = f((\bigvee A)^{**})^{**} = f(\bigvee A)^{**} = (\bigvee f[A])^{**}. $$

    Now, take any $a\in A$, from $f(a) \leq \bigvee f[A]$ we have $f(a)^{**} \leq (\bigvee f[A])^{**}$. Since $a$ was chosen arbitrary, we also have $\bigvee_{a\in A} f(a)^{**} \leq (\bigvee f[A])^{**}$ and therefore $(\bigvee_{a\in A} f(a)^{**})^{**} \leq (\bigvee f[A])^{**}$. The opposite inequality is trivial, hence $\bigsqcup (\Bo f)[A] = (\bigvee f[A])^{**}$.

    To sum up everything, we have
    $$ \bigsqcup (\Bo f)[A] = (\bigvee f[A])^{**} = (\Bo f)(\bigsqcup A),$$
    \noindent which is what we wanted.
\end{proof}

\begin{proposition}\label{p:BooleanizationFunctor}
    Let $\p C$ be a subcategory of the category of frames and frame homomorphisms satisfying (\oldref{e:2202iff20leq02}). Then

    $$\Bo\colon \p C \to \ComplBool,$$

    \noindent defined on objects as is in~\ref{d:Booleanization} and on morphisms as is in~\ref{d:BooleanizationMorph}, is a functor.
    % TODO do not reference inside a proof -- ref{e:2202iff20leq02}
\end{proposition}
\begin{proof}
    From~\ref{p:propertiesBooleanization} we know $\Bo L$ is a complete Boolean algebra. As a direct implication of Proposition~\ref{p:boolenizationCond} we get that for any morphism $f\colon L \to M$ in $\p C$, the following diagram commutes.

    \begin{diagram}
        L \ar{r}{\beta_L} \ar{d}{f} & \Bo L \ar{d}{\Bo f}\\
        M \ar{r}{\beta_M}           & \Bo M
    \end{diagram}

    \noindent $\Bo f$ is a frame homomorphisms, but it is also a complete Boolean homomorphisms, as we know from~\ref{p:kappaCompleteBAfromMeets}. Since the following diagram also commutes, for any morphisms $f, g$, we can see $\Bo$ respect morphisms composition.

    \begin{diagram}
        L \ar{r}{\beta_L}
          \ar{d}{f}
          \ar[bend right]{dd}[swap]{gf} &
        \Bo L \ar{d}[swap]{\Bo f}
              \ar[bend left]{dd}{\Bo (gf)}\\

        M \ar{r}{\beta_M} \ar{d}{g} & \Bo M \ar{d}[swap]{\Bo g}\\
        N \ar{r}{\beta_N}           & \Bo N
    \end{diagram}

    Finally, for any identity frame homomorphism $i_L$, $\Bo i_L$ is the identity on $\Bo L$. Consequently, $\Bo$ is a functor.
\end{proof}

\begin{lemma}\label{p:basicalMorphs}
    Let $f\colon L \to M$ be a frame homomorphism and $a \in L$ such that $a^{**}\vee a^* = 1$, then
    $$ f(a^{**})^* = f(a^*).$$

    In particular, for $a = a^{**}$ we have
    $$ f(a)^* = f(a^*).$$
\end{lemma}
\begin{proof}
    From the assumptions we see the following holds
    \begin{align*}
        f(a^{**}) \vee f(a^*) &= f(a^{**} \vee a^*) = 1, \\
        f(a^{**}) \wedge f(a^*) &= f(a^{**} \wedge a^*)  =  0.
    \end{align*}

    Hence $f(a^{**})$ is complemented and $f(a^*)$ is its complement. From distributivity of $M$ we know, complements are unique, hence $f(a^*) = f(a^{**})^*$.
\end{proof}

\num\label{p:BooleanizationFunctorOnExtrDSF} For any frame homomorphism between two extremally disconnected Stone frames $f\colon L\to M$, by Lemma~\ref{p:basicalMorphs}, $f(a^{**})^* = f(a^*)$ for all $a\in L$. Observe, we have
    \begin{align*}
        f(a^{**})^* = f(a^*)\text{ and }f(a^{**}) \leq f(a)^{**} \iff f(a^*) = f(a)^*,\quad\text{for all } a\in L.\label{e:1001}\tag{N.O.}
    \end{align*}

    \noindent (Indeed, the $f(a^*) \leq f(a)^*$ is always true and $f(a^*) = f(a^{**})^* \geq f(a)^{***} = f(a)^*$, the opposite direction is straightforward).

    Hence, for a category of extremally disconnected frames, in order to satisfy conditions of Proposition~\ref{p:BooleanizationFunctor}, we need to restrict morphisms only to those frame homomorphisms satisfying~(\oldref{e:1001}).

    However, this is exactly the case with morphisms of the category \ExtrStoneFrm{}. For a frame homomorphism, to be basically complete is precisely the same as to satisfy~(\oldref{e:1001}).

\begin{conclusion*}
    $\Bo\colon \ExtrStoneFrm \to \ComplBool$ is a functor.
\end{conclusion*}

In literature are frame homomorphisms satisfying (\oldref{e:2202iff20leq02}) called \DEF{weakly open} and frame homomorphisms satisfying (\oldref{e:1001}) are called \DEF{nearly open}~\cite{banaschewski1994variants}.
% TODO topological interpretation

\begin{observation}\label{p:boEQbc}
    $\Bo L = \BcI L$ for any extremally disconnected Stone frame $L$.
\end{observation}
\begin{proof}
    $\Bo L \supseteq \BcI L$ holds always. Let $x \in \Bo L$, then $x = x^{**}$ and from extremal disconnectedness also $x^{**}\vee x^*=1$, hence $x \in \BcI L$.
\end{proof}


Until the end of this section, we will use Lemma~\ref{p:idealsFrame} frequently without further referencing.

\begin{proposition}
    The functor $\Bo\circ\JI$ is naturally equivalent to the identity functor on \ComplBool{}.
\end{proposition}
\begin{proof}
    Let $B$ be a Boolean frame. We see $J \in \Bo\JI(B)$ iff $J = J^{**} = \downset \bigvee J$.

    Denote \DEFSYM{istar2}{$\tilde i_B$}$\colon B \to \Bo\JI(B)$ to be the mapping $a \mapsto \downset a$. From the previous Observation we know the definitions of $\tilde i_B$ and $i_B$ coincide, therefore by~\ref{p:BoolEquivalence} $\tilde i_B$ is a Boolean isomorphism. From~\ref{p:completePartUnits}, $\tilde i_B$ is a morphisms of \ComplBool{}.

    Now, for any complete Boolean algebras $A$ and $B$, for any complete Boolean homomorphism $f\colon A \to B$, the following diagram commutes
    \begin{diagram}
        A \ar{r}{\tilde i_A} \ar{d}[swap]{f} & \Bo\JI(A) \ar{d}{\Bo\J(f)}\\
        B \ar{r}{\tilde i_B}                 & \Bo\JI(B)
    \end{diagram}

    \noindent Indeed, we have
    $$
    \Bo\JI(f)(\downset a) = (\downset f[\downset a])^{**} = \downset f(a)^{**} = \downset f(a).
    $$

    Hence, the collection $\tilde i_*$ of complete Boolean homomorphisms forms a natural equivalence between $\Bo\JI$ and the identity functor on \ComplBool.
\end{proof}

\begin{proposition}\label{p:JOBoIdentity}
    The functor $\JI\circ\Bo$ is naturally equivalent to the identity functor on \ExtrStoneFrm{}.
\end{proposition}
\begin{proof}
    Let $L$ be an extremally disconnected Stone frame. Similarly to the general case, define \DEFSYM{vstar2}{$\tilde v_L$}$\colon \JI\Bo(L) \to L$ as
    $$ \tilde v_L\colon I \mapsto \bigvee I.$$

    \noindent From Observation~\ref{p:boEQbc}, we know the definitions of $\tilde v_L$ and $v_L$ are the same, and $\tilde v_L$ is a frame isomorphism by~\ref{p:StoneFrmEquivalence}. From~\ref{p:completePartUnits}, $\tilde v_L$ is a morphism of \ExtrStoneFrm.

    Further, let $L$ and $M$ be extremally disconnected Stone frames and let $f\colon L \to M$ be a basically complete frame homomorphism. The following diagram commutes
    \begin{diagram}
        \JI\Bo(L) \ar{d}[swap]{\JI\Bo(f)} \ar{r}{\tilde v_L} & L \ar{d}{f} \\
        \JI\Bo(M) \ar{r}{\tilde v_M}    & M
    \end{diagram}

    To show that, let $I \in \JI\Bo(L)$. First observe, for $x\in I$, $x = x^{**}$ and since $L$ is extremally disconnected, $x\vee x^* = 1$. Therefore, $f(x^*) = f(x)^*$ by Lemma~\ref{p:basicalMorphs}. Now, we can compute
    $$
    (\JI\Bo)(f)(I) = \downset \Set{ f(x)^{**} | x \in I } = \downset \Set{ f(x) | x \in I} = \downset f[I].
    $$

    \noindent And from that, we see
    $$
    \tilde v_M((\JI\Bo)(f)(I)) = \bigvee \downset f[I] = \bigvee f[I] = f(\bigvee I) = f(\tilde v_L(I)).
    $$

    The conclusion follows from commutativity of the diagram above.
    The collection $\tilde v_*$ of basically complete frame homomorphisms is a natural equivalence between $\JI\Bo$ and the identity functor on \ExtrStoneFrm.
\end{proof}


\num From \ref{p:BooleanizationFunctorOnExtrDSF}---\ref{p:JOBoIdentity}, we obtain the main result of this section.

\begin{theorem*}
    The functors \Bo{} and \JI{} provide an isomorphism between the categories \\\ExtrStoneFrm{} and \ComplBool{}.
\end{theorem*}

% TODO
% \num Observe that $\Bo$ provides an isomorphism precisely for this part of Stone correspond. For a frame $L$, $\Bo L$ is always a complete Boolean algebra and the frame $\JI\Bo(L)$ is extremally disconnected.

% TODO and by \ref{e:1001} we cannot hope to ommit condition to have weakly open frame homomorphismsa?
